#include <stdlib.h>
#include <bios.h>
#include <stdarg.h>
#include <mem.h>
#include <fcntl.h>
#include <io.h>

unsigned int BossScreen[]={
0x0720, 0x7020, 0x74F0, 0x7020, 0x7020, 0x7446, 0x7069, 0x706C, 0x7065, 0x7020,
0x7020, 0x7445, 0x7064, 0x7069, 0x7074, 0x7020, 0x7020, 0x7453, 0x7065, 0x7061, 
0x7072, 0x7063, 0x7068, 0x7020, 0x7020, 0x7452, 0x7075, 0x706E, 0x7020, 0x7020,
0x7443, 0x706F, 0x706D, 0x7070, 0x7069, 0x706C, 0x7065, 0x7020, 0x7020, 0x7444, 
0x7065, 0x7062, 0x7075, 0x7067, 0x7020, 0x7020, 0x7450, 0x7072, 0x706F, 0x706A, 
0x7065, 0x7063, 0x7074, 0x7020, 0x7020, 0x744F, 0x7070, 0x7074, 0x7069, 0x706F, 
0x706E, 0x7073, 0x7020, 0x7020, 0x7020, 0x7020, 0x7457, 0x7069, 0x706E, 0x7064,
0x706F, 0x7077, 0x7020, 0x7020, 0x7448, 0x7065, 0x706C, 0x7070, 0x7020, 0x7020, 
0x1FC9, 0x1FCD, 0x1F5B, 0x1AFE, 0x1F5D, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 
0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 
0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD,
0x1FCD, 0x1FCD, 0x1FCD, 0x1F20, 0x1F54, 0x1F45, 0x1F54, 0x1F52, 0x1F4F, 0x1F50, 
0x1F41, 0x1F4B, 0x1F2E, 0x1F43, 0x1F50, 0x1F50, 0x1F20, 0x1FCD, 0x1FCD, 0x1FCD,
0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD,
0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD,
0x1FCD, 0x1FCD, 0x1FCD, 0x1F32, 0x1FCD, 0x1F5B, 0x1A12, 0x1F5D, 0x1FCD, 0x1FBB, 
0x1FBA, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x311E,
0x1FBA, 0x1F76, 0x1F6F, 0x1F69, 0x1F64, 0x1E20, 0x1E54, 0x1E65, 0x1E74, 0x1E72, 
0x1E69, 0x1E73, 0x1F3A, 0x1F3A, 0x1E44, 0x1E6F, 0x1E77, 0x1E6E, 0x1F28, 0x1F29, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1F7B, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1E43, 0x1E75, 0x1E72, 0x1E49, 0x1E74, 0x1E65, 0x1E6D,
0x1F2D, 0x1F3E, 0x1E44, 0x1E6F, 0x1E77, 0x1E6E, 0x1F28, 0x1F29, 0x1F3B, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1F69, 0x1F66, 0x1F28, 0x1F2A, 0x1E42, 0x1E6F, 0x1E78, 
0x1E20, 0x1F26, 0x1F26, 0x1E20, 0x1F2A, 0x1E43, 0x1E75, 0x1E72, 0x1E49, 0x1E74,
0x1E65, 0x1E6D, 0x1E20, 0x1F29, 0x1E20, 0x1F72, 0x1F65, 0x1F74, 0x1F75, 0x1F72, 
0x1F6E, 0x1F3B, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1F65, 0x1F6C, 0x1F73, 0x1F65, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x7FC9, 
0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 
0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7F20, 0x7F4C, 0x7F69, 0x7F6E, 0x7F6B, 
0x7F69, 0x7F6E, 0x7F67, 0x7F20, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD,
0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FBB, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1F7B, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x7FBA, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7FBA, 
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1E43, 0x1E75, 0x1E72, 0x1E49, 0x1E74, 0x1E65, 0x1E6D,
0x1F2D, 0x1F3E, 0x1E55, 0x1E70, 0x1F28, 0x1F29, 0x1F3B, 0x1E20, 0x1E20, 0x7FBA,
0x7020, 0x7045, 0x7058, 0x7045, 0x7020, 0x7066, 0x7069, 0x706C, 0x7065, 0x7020,
0x703A, 0x7020, 0x7054, 0x7045, 0x7054, 0x7052, 0x704F, 0x7050, 0x7041, 0x704B,
0x702E, 0x7045, 0x7058, 0x7045, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7FBA, 
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1F2A, 0x1E42, 0x1E6F, 0x1E78, 0x1F3D, 0x1F2A, 0x1E42,
0x1E6F, 0x1E78, 0x1F2B, 0x1E20, 0x1F2A, 0x1E43, 0x1E75, 0x1E72, 0x1E49, 0x7FBA, 
0x7020, 0x704C, 0x7069, 0x706E, 0x706B, 0x7069, 0x706E, 0x7067, 0x7020, 0x7020, 
0x703A, 0x7020, 0x705C, 0x7042, 0x7043, 0x705C, 0x704C, 0x7049, 0x7042, 0x705C, 
0x7043, 0x704D, 0x702E, 0x704C, 0x7049, 0x7042, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7FBA, 
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1F69, 0x1F6E, 0x1F74, 0x1E20, 0x1E43, 0x1E75, 0x1E72,
0x1E53, 0x1E63, 0x1E6F, 0x1E72, 0x1E65, 0x1F3D, 0x1B30, 0x1F2C, 0x1E53, 0x7FBA, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020,
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7FBA,
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1F77, 0x1F68, 0x1F69, 0x1F6C, 0x1F65, 0x1F28, 0x1E20, 
0x1F28, 0x1E43, 0x1E75, 0x1E72, 0x1E53, 0x1E63, 0x1E6F, 0x1E72, 0x1E65, 0x7FBA, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7054, 0x706F, 0x7074, 0x7061, 0x706C, 0x7020, 0x7020, 0x7020, 0x7020, 0x704C,
0x7069, 0x706E, 0x706B, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7FBA,
0x0829, 0x083B, 0x1E20, 0x1E42, 0x1E6F, 0x1E78, 0x1F2D, 0x1F3E, 0x1E53, 0x1E68, 
0x1E6F, 0x1E77, 0x1F28, 0x1F29, 0x1F3B, 0x1E20, 0x1F7D, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1E47, 0x1E65, 0x1E74, 0x1E4E, 0x1E65, 0x1E78, 0x1E74, 
0x1F28, 0x1F29, 0x1F3B, 0x1E20, 0x1E53, 0x1E68, 0x1E6F, 0x1E77, 0x1E4E, 0x7FBA, 
0x7020, 0x7020, 0x7020, 0x7020, 0x704C, 0x7069, 0x706E, 0x7065, 0x7073, 0x7020, 
0x7063, 0x706F, 0x706D, 0x7070, 0x7069, 0x706C, 0x7065, 0x7064, 0x703A, 0x7020, 
0x7039, 0x7038, 0x7037, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7050, 
0x7041, 0x7053, 0x7053, 0x7020, 0x7032, 0x7020, 0x7020, 0x7020, 0x7020, 0x7FBA, 
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1F69, 0x1F66, 0x1F28, 0x1E20, 0x1F21, 0x1F28, 0x1F2A,
0x1E42, 0x1E6F, 0x1E78, 0x1E20, 0x1F26, 0x1F26, 0x1E20, 0x1F2A, 0x1E43, 0x7FBA,
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020,
0x7057, 0x7061, 0x7072, 0x706E, 0x7069, 0x706E, 0x7067, 0x7073, 0x703A, 0x7020, 
0x7030, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7030, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7FBA, 
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1F7B, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x7FBA, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7045, 0x7072, 0x7072, 0x706F, 0x7072, 0x7073, 0x703A, 0x7020, 
0x7030, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7030, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7FBA, 
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1,
0x1FBA, 0x1E20, 0x1E20, 0x1E20, 0x1E53, 0x1E68, 0x1E6F, 0x1E77, 0x1E53, 0x1E63, 
0x1E6F, 0x1E72, 0x1E65, 0x1E73, 0x1F28, 0x1F29, 0x1F3B, 0x1E20, 0x1E20, 0x7FBA, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020,
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7FBA,
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x31FE, 
0x1FBA, 0x1E20, 0x1E20, 0x1E20, 0x1E62, 0x1E61, 0x1E72, 0x1F28, 0x1B33, 0x1B34, 
0x1F2C, 0x1B31, 0x1B31, 0x1F2C, 0x1B31, 0x1B33, 0x1F2C, 0x1B33, 0x1F2C, 0x7FBA, 
0x7020, 0x7020, 0x7041, 0x7076, 0x7061, 0x7069, 0x706C, 0x7061, 0x7062, 0x706C, 
0x7065, 0x7020, 0x706D, 0x7065, 0x706D, 0x706F, 0x7072, 0x7079, 0x703A, 0x7020, 
0x7031, 0x7031, 0x7035, 0x7032, 0x704B, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020,
0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7020, 0x7FBA, 
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1E20, 0x1E53, 0x1E68, 0x1E6F, 0x1E77, 0x1E53, 0x1E74, 
0x1E72, 0x1F28, 0x1B33, 0x1B36, 0x1F2C, 0x1B31, 0x1B32, 0x1F2C, 0x1B22, 0x7FBA, 
0x1320, 0x1320, 0x1353, 0x1375, 0x1363, 0x1363, 0x1365, 0x1373, 0x1373, 0x1320, 
0x1320, 0x1320, 0x1320, 0x1320, 0x1320, 0x1320, 0x1320, 0x1320, 0x133A, 0x9320, 
0x9320, 0x9320, 0x9320, 0x9350, 0x9372, 0x9365, 0x9373, 0x9373, 0x9320, 0x9361, 
0x936E, 0x9379, 0x9320, 0x936B, 0x9365, 0x9379, 0x9320, 0x9320, 0x9320, 0x7FBA, 
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1E20, 0x1F75, 0x1F6E, 0x1F73, 0x1F69, 0x1F67, 0x1F6E,
0x1F65, 0x1F64, 0x1E20, 0x1F6C, 0x1F6F, 0x1F6E, 0x1F67, 0x1E20, 0x1F66, 0x7FC8,
0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD,
0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 
0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 
0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FCD, 0x7FBC, 
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1E20, 0x1F75, 0x1F6E, 0x1F73, 0x1F69, 0x1F67, 0x1F6E,
0x1F65, 0x1F64, 0x1E20, 0x1F6C, 0x1F6F, 0x1F6E, 0x1F67, 0x1E20, 0x1E45, 0x1E6E, 
0x1E64, 0x0854, 0x0869, 0x086D, 0x0865, 0x083D, 0x082A, 0x0854, 0x0869, 0x086D, 
0x0865, 0x0872, 0x082B, 0x0831, 0x0830, 0x083B, 0x0820, 0x0820, 0x0820, 0x0820, 
0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 
0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 0x0820, 
0x0820, 0x0820, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1, 
0x1FBA, 0x1E20, 0x1E20, 0x1E20, 0x1F77, 0x1F68, 0x1F69, 0x1F6C, 0x1F65, 0x1F28, 
0x1F2A, 0x1E54, 0x1E69, 0x1E6D, 0x1E65, 0x1E72, 0x1F3C, 0x1E45, 0x1E6E, 0x1E64, 
0x1E54, 0x1E69, 0x1E6D, 0x1E65, 0x1F29, 0x1E20, 0x1F69, 0x1F66, 0x1F28, 0x1E62, 
0x1E69, 0x1E6F, 0x1E73, 0x1E6B, 0x1E65, 0x1E79, 0x1F28, 0x1B31, 0x1F29, 0x1F29, 
0x1E20, 0x1E49, 0x1E6E, 0x1E70, 0x1E75, 0x1E74, 0x1E4B, 0x1E65, 0x1E79, 0x1F28,
0x1F29, 0x1F3B, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x13B1,
0x1FBA, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E49, 0x1E6E, 0x1E70, 0x1E75, 0x1E74,
0x1E4B, 0x1E65, 0x1E79, 0x1F28, 0x1F29, 0x1F3B, 0x1E20, 0x1E65, 0x1E78, 0x1E69,
0x1E74, 0x1F3D, 0x1B31, 0x1F3B, 0x1E20, 0x1F72, 0x1F65, 0x1F74, 0x1F75, 0x1F72,
0x1F6E, 0x1E20, 0x1F3B, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20,
0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x1E20, 0x311F,
0x1FC8, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x1F20, 0x1F37, 0x1F33, 0x1F32,
0x1F3A, 0x1F33, 0x1F33, 0x1F20, 0x1FCD, 0x1FCD, 0x1FCD, 0x1FCD, 0x3111, 0x31FE,
0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1,
0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1,
0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1,
0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1,
0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1,
0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x13B1, 0x3110, 0x1AC4, 0x1AD9,
0x7020, 0x7446, 0x7431, 0x7020, 0x7048, 0x7065, 0x706C, 0x7070, 0x7020, 0x7020,
0x7441, 0x746C, 0x7474, 0x742D, 0x7446, 0x7438, 0x7020, 0x704E, 0x7065, 0x7078,
0x7074, 0x7020, 0x704D, 0x7073, 0x7067, 0x7020, 0x7020, 0x7441, 0x746C, 0x7474,
0x742D, 0x7446, 0x7437, 0x7020, 0x7050, 0x7072, 0x7065, 0x7076, 0x7020, 0x704D,
0x7073, 0x7067, 0x7020, 0x7020, 0x7441, 0x746C, 0x7474, 0x742D, 0x7446, 0x7439,
0x7020, 0x7043, 0x706F, 0x706D, 0x7070, 0x7069, 0x706C, 0x7065, 0x7020, 0x7020,
0x7446, 0x7439, 0x7020, 0x704D, 0x7061, 0x706B, 0x7065, 0x7020, 0x7020, 0x7446,
0x7431, 0x7430, 0x7020, 0x704D, 0x7065, 0x706E, 0x7075, 0x7020, 0x7020, 0x7020
};

void BossKey();
void cls();

int InputKey ()
{
  int key=bioskey(0);
  if(key==0x3b00)
  {
   BossKey();
   if(bioskey(0)==0x2d00) { cls(); exit(0);}
   BossKey(); return 0;
   } else return key;
}

void ShowStr(int x,int y,char *str,char color)
{
 char far *Video=(char far *)0xb8000000l+y*160+x*2;
 while(*str) { *(Video++)=*str++; *(Video++)=color; }
}

void ShowDigit(int x,int y,long val,char color)
{
 char far *Video=(char far *)0xb8000000l+y*160+x*2;
 while((val+9)/10) { *(Video--)=val%10+48;*(Video+2)=color; Video--; val/=10; }
}

void cls() {  unsigned far *Video=(unsigned far *)0xb8000000l; for(int i=0;i<80*25;i++,Video++) *Video=0x700; }

int HomeLevel=9,LeftKey=0x4b00,RightKey=0x4d00,RotKey=0x5000,DropKey=0x3920;

void bar(int x,int y,int w,int h,char color)
{
 char far *Video=(char far *)0xb8000000l+y*160+x*2;
 for(int xt=0;xt<w;++xt)
  for(int yt=0;yt<h;++yt)
  {
   *(Video+yt*160+(xt<<1))='Û';
   *(Video+yt*160+(xt<<1)+1)=color;
   }
}

void SetCur(char x,char y)
{
  asm{
	mov	ah,2
	mov	bh,0
	mov	dl,x
	mov	dh,y
	int	10h
  }

}

void Input(int x,int y,int len,char *str,int col)
{
 int pos=0;
 int key;
 for(;;)
 {
  SetCur(x+pos,y);
  ShowStr(x,y,str,col);
  switch(key=InputKey())
  {
   case	0x11b:
   case	0x1c0d: SetCur(26,26); return;
   case 0x4b00:
   case 0x0e08: if(pos>0)pos--; str[pos]=' '; break;
   default:     if(pos<len-1) { str[pos]=key; pos++; } break;
   }
  }
}


void  SetLevel()
{
 ShowStr(35,9,"Set Level",12);
for(;;)
{
 bar(30,11,20,1,0);
 ShowDigit(39,11,22-HomeLevel,14);
 switch(InputKey())
  {
   case 0x5000:
   case 0x4d00: if(HomeLevel>2)  HomeLevel--; break;
   case 0x4800:
   case 0x4b00: if(HomeLevel<21) HomeLevel++;  break;
   case	0x11b :
   case	0x1c0d: return ;
   }
 }
}

void  DefineKey()
{
 ShowStr(33,9,"Define Keys",12);
 ShowStr(36,11,"Left",14);   LeftKey=InputKey();
 ShowStr(36,12,"Right",14);  RightKey=InputKey();
 ShowStr(36,13,"Rotate",14); RotKey=InputKey();
 ShowStr(36,14,"Drop",14);   DropKey=InputKey();
}

class TItem
{
public:
 int	X,Y,W,H;
 char  *Array;
 TItem(int w,int h,int col,...);
 TItem(int w,int h);
 TItem();
 TItem(TItem& op);
 virtual ~TItem() {  delete Array; }
 TItem& operator = (TItem& op);
	 int	In(int x,int y);
	 void	Up()    { Y--; }
	 void	Down()  { Y++; }
	 void	Left()  { X--; }
	 void	Right() { X++; }
 virtual TItem  Rot();
 virtual int	Del();
 virtual void	Show();
	 void	GoTo(int x,int y) { X=x; Y=y; }
 friend TItem operator +  (TItem& op1,TItem& op2);
 friend int   operator && (TItem& op1,TItem& op2);
};

class TItemCol: public TItem
{
 public:
 TItemCol(int w,int h): TItem(w,h) {}
 int	Del();
};

class TItemColum: public TItem
{
 public:
 TItemColum(int w,int h,int col0,int col1,int col2): TItem(w,h,col0,col1,col2) {}
 TItemColum(int w=1,int h=3): TItem(w,h) {}
 TItem	Rot();
};

class Tetris
{
  int exit;
 protected:
  int ItemsAll;
  int Level;
  int LineDel;
  long Scores;
  TItem *Box;
  TItem *Items[30];
  TItem *CurItem,*NextItem;
  int XNext,YNext;
  enum { QuitKey=0x11b};
  public:
  Tetris(int x,int y,int w,int h,int xNext=1,int yNext=1);
  ~Tetris();
		long	Run();
  virtual 	void	CheckLevel(int Score);
  virtual       void	Bonus(int bonus);
		void    Drop();
  virtual 	void	GetNext();
		void	ShowNext();
		void	ShowScores();
		int	Delay(int Tik);
		void	Down();
};

class Pentix: public Tetris
{
 public:
  Pentix(int x,int y,int w,int h,int xNext=1,int yNext=1);
};


class TetColor: public Tetris
{
 public:
  TetColor(int x,int y,int w,int h,int xNext=1,int yNext=1):Tetris(x,y,w,h,xNext,yNext) { delete Box; Box=new TItemCol(w,h); Box->GoTo(x,y); }
  char  GetCol() { char col=random(6)+9; if(col==10) col=2; return col; }
  void	GetNext();
  void  CheckLevel(int Score);
};

class Columns: public TetColor
{
 public:
  Columns(int x,int y,int w,int h,int xNext=1,int yNext=1);
  void	GetNext();
};

//---------------------------------------------------------------------------

TItem::TItem(int w,int h)
{
 X=Y=0; W=w; H=h;
 Array = new char[W*H];
 setmem(Array,W*H,0);
 }

TItem::TItem() {  W=H=0; Array = 0; }

TItem::TItem(int w,int h,int col,...)
{
 X=Y=0; W=w; H=h;
 va_list List;
 List = (va_list)&col;
 Array = new char[W*H];
 for(int y=0;y<H;++y)
  for(int x=0;x<W;++x)
	Array[x+y*W] = va_arg(List,int);
}

TItem::TItem(TItem& op) : Array(0) {  *this = op; }

TItem& TItem::operator = (TItem& op)
{
 X=op.X; Y=op.Y; W=op.W; H=op.H;
 if(W && H)
 {
  delete Array;
  Array = new char[W*H];
  memcpy (Array,op.Array,W*H);
  }
 return *this;
 }

int	TItem::In(int x,int y)
{ if(x>=X && y>=Y && x<X+W && y<Y+H) return 1; else return 0; }

TItem operator + (TItem& op1,TItem& op2)
{
 TItem RetItem=op1;
 for(int x=0;x<op1.W;++x)
  for(int y=0;y<op1.H;++y)
   if(op1.In(x+op1.X,y+op1.Y) && op2.In(x+op1.X,y+op1.Y)) RetItem.Array[x+y*op1.W]+=op2.Array[x-(op2.X-op1.X)+(y-(op2.Y-op1.Y))*op2.W];
 return RetItem;
}

TItem  TItem::Rot()
{
 TItem RetItem=*this;
 RetItem.W=H; RetItem.H=W;
 for(int x=0;x<W;++x)
  for(int y=0;y<H;++y)
   RetItem.Array[y+x*H]=Array[W-x-1+y*W];
 return RetItem;
}

int   operator && (TItem& op1,TItem& op2)
{
 if(op1.X>op2.X || op1.Y>op2.Y || op1.X+op1.W<op2.X+op2.W || op1.Y+op1.H<op2.Y+op2.H ) return 0;
 for(int x=0;x<op1.W;++x)
  for(int y=0;y<op1.H;++y)
   if(op1.In(x+op1.X,y+op1.Y) && op2.In(x+op1.X,y+op1.Y))
    if(op1.Array[x+y*op1.W] && op2.Array[x-(op2.X-op1.X)+(y-(op2.Y-op1.Y))*op2.W]) return 0;
 return 1;
 }

int	TItem::Del()
{
 for(int y=0;y<H;++y)
 {
  int val=0;
  for(int x=0;x<W;++x) if(!Array[x+y*W]) val++;
  if(!val)
  {
   if(y) memmove(Array+W,Array,y*W);
   setmem (Array,W,0);
   return W;
   }
  }
  return 0;
 }

void	TItem::Show()
{
 char far *Video=(char far *)0xb8000000l+Y*160+X*4;
 for(int x=0;x<W;++x)
  for(int y=0;y<H;++y)
  {
   *(Video+y*160+(x<<2))='Û'; *(Video+y*160+(x<<2)+2)='Û';
   *(Video+y*160+(x<<2)+1)=Array[x+y*W]; *(Video+y*160+(x<<2)+3)=Array[x+y*W];
   }
}

TItem  TItemColum::Rot()
{
 TItem RetItem=*this;
 char tmp=RetItem.Array[0];
 RetItem.Array[0]=RetItem.Array[1];
 RetItem.Array[1]=RetItem.Array[2];
 RetItem.Array[2]=tmp;
 return RetItem;
}

int	TItemCol::Del()
{
 int RetVal=0;
 TItem TmpItem=*this;
 for(int y=0;y<H;++y)
  for(int x=0;x<W;++x)
  {
   int cnt=0,i;
   if (Array[y*W+x]) for(;( Array[y*W+x]==Array[y*W+x+cnt] && x+cnt<W);++cnt);
   if(cnt>2) for(i=0;i<cnt;++i) TmpItem.Array[y*W+x+i]=0xff;
   cnt=0;
   if (Array[y*W+x]) for(cnt=0;( Array[y*W+x]==Array[(y+cnt)*W+x] && y+cnt<H );++cnt);
   if(cnt>2) for(i=0;i<cnt;++i) TmpItem.Array[(y+i)*W+x]=0xff;
   cnt=0;
   if (Array[y*W+x]) for(cnt=0;( Array[y*W+x]==Array[(y+cnt)*W+x+cnt] && y+cnt<H && x+cnt<W);++cnt);
   if(cnt>2) for(i=0;i<cnt;++i) TmpItem.Array[(y+i)*W+x+i]=0xff;
   cnt=0;
   if (Array[y*W+x]) for(cnt=0;( Array[y*W+x]==Array[(y+cnt)*W+x-cnt] && y+cnt<H && x-cnt>=0 );++cnt);
   if(cnt>2) for(i=0;i<cnt;++i) TmpItem.Array[(y+i)*W+x-i]=0xff;
   cnt=0;
  }
  TmpItem.Show();
  for(y=0;y<H;++y)
   for(int x=0;x<W;++x)
   {
	if(TmpItem.Array[y*W+x]==-1)
	{
	 RetVal++;
	 for(int i=y;i>0;--i) Array[i*W+x]=Array[(i-1)*W+x];
	 Array[x]=0;
	 }
	}
  return RetVal;
 }


 void Tetris::Bonus(int bonus)
 {
  Scores+=bonus;
  ShowStr((XNext<<1)-2,YNext+7,"Bonus:",14);
  ShowDigit((XNext<<1)+10,YNext+7,bonus,14);
 }

 Tetris::~Tetris()
 {
  delete Box;
  delete CurItem;
  delete NextItem;
  for(int i=0;i<ItemsAll;++i) delete Items[i];
 }


void TetColor::CheckLevel(int Score)
{
 Scores+=Score;
 if(Score>3) Bonus((Score-3)*(Score-3)*5);
 ++LineDel;
 if(LineDel>20)
 {
  LineDel=0;
  if(Level>2) --Level;
  }
}



Columns::Columns(int x,int y,int w,int h,int xNext,int yNext):TetColor(x,y,w,h,xNext,yNext)
{
 delete CurItem;
 delete NextItem;
 delete Box;
 CurItem=new TItemColum;
 NextItem=new TItemColum;
 Box=new TItemCol(w,h); Box->GoTo(x,y);
 }

void	Columns::GetNext()
{
 *CurItem=*NextItem; ++Scores;
 TItemColum NewItem(1,3,GetCol(),GetCol(),GetCol());
 *NextItem=NewItem;
 CurItem->GoTo( Box->X+((Box->W-CurItem->W)>>1),Box->Y );
 }

void	TetColor::GetNext()
{
 *CurItem=*NextItem; ++Scores;
 int w=random(3)+1;
 int h=random(3-w+1)+1;
 int col;
 if(w==h && w==2) col=0; else col=GetCol();
 TItem NewItem(w,h,col,GetCol(),GetCol(),GetCol(),GetCol(),GetCol(),GetCol());
 *NextItem=NewItem;
 CurItem->GoTo( Box->X+((Box->W-CurItem->W)>>1),Box->Y );
 }

void	Tetris::GetNext()
{
 *CurItem=*NextItem; ++Scores;
 *NextItem=*Items[random(ItemsAll)];
 CurItem->GoTo( Box->X+((Box->W-CurItem->W)>>1),Box->Y );
 }

void	Tetris::ShowNext()
{
 bar((XNext<<1)-3,YNext,15,10,0);
 NextItem->GoTo(XNext,YNext);
 NextItem->Show();
}

void	Tetris::ShowScores()
{
 ShowStr((XNext<<1)-2,YNext+6,"Score:",14);
 ShowDigit((XNext<<1)+10,YNext+6,Scores,14);
}

int Tetris::Delay(int Tik)
{
 unsigned long far *Timer=(unsigned long far *)0x46cl;
 unsigned long EndTime=*Timer+Tik;
 while(*Timer<EndTime) if(bioskey(1)) return 0;
 return 1;
}

Pentix::Pentix(int x,int y,int w,int h,int xNext,int yNext):Tetris(x,y,w,h,xNext,yNext)
{
 ItemsAll=28;
 Items[6]=new TItem(1,1,1);
 Items[7]=new TItem(3,3,11,0,0,
			11,11,11,
			11,0,0 );
 Items[8]=new TItem(3,3,0,2,0,
			2,2,2,
			0,2,0 );
 Items[9]=new TItem(1,3,3,3,3);
 Items[10]=new TItem(1,5,4,4,4,4,4);
 Items[11]=new TItem(1,2,5,5);

 Items[12]=new TItem(3,3,4,4,0,
			 0,4,4,
			 0,0,4 );
 Items[13]=new TItem(3,3,0,5,5,
			 0,5,0,
			 5,5,0 );

 Items[14]=new TItem(2,4,6,6,
			 0,6,
			 0,6,
			 0,6 );
 Items[15]=new TItem(2,4,14,14,
			 14,0,
			 14,0,
			 14,0 );

 Items[16]=new TItem(2,2,6,6,
			 6,0 );

 Items[17]=new TItem(3,2,0,7,0,
			 7,7,7);

 Items[18]=new TItem(3,3,0,9,0,
			 9,9,9,
			 0,0,9);
 Items[19]=new TItem(3,3,0,10,0,
			 10,10,10,
			 10,0,0);

 Items[20]=new TItem(2,4,14, 0,
			 14,14,
			  0,14,
			  0,14);
 Items[21]=new TItem(2,4, 0,12,
			 12,12,
			 12, 0,
			 12, 0);
 Items[22]=new TItem(2,4,15,0,
			 15,15,
			 15,0,
			 15,0);
 Items[23]=new TItem(2,4,0 ,10,
			 10,10,
			 0 ,10,
			 0 ,10);

 Items[24]=new TItem(3,2,12,12,12,
			 12, 0,12);

 Items[25]=new TItem(3,3,7,7,7,
			 7,0,0,
			 7,0,0);
 Items[26]=new TItem(2,3,13,13,
			 13,13,
			 13,0);

 Items[27]=new TItem(2,3,1,1,
			 1,1,
			 0,1);

 }

Tetris::Tetris(int x,int y,int w,int h,int xNext,int yNext)
{
 NextItem=new TItem; CurItem=new TItem;
 Level=HomeLevel;
 Scores=LineDel=0;
 Box=new TItem(w,h); Box->GoTo(x,y);
 XNext=xNext; YNext=yNext;
 ItemsAll=6;
 Items[0]=new TItem(2,2,9,9,9,9);
 Items[1]=new TItem(2,3,10,10,10,0,10,0);
 Items[2]=new TItem(2,3,11,11,0,11,0,11);
 Items[3]=new TItem(2,3,12,0,12,12,0,12);
 Items[4]=new TItem(2,3,0,13,13,13,13,0);
 Items[5]=new TItem(1,4,14,14,14,14);
 }

void Tetris::CheckLevel(int Score)
{
 Scores+=Score;
 if(Score>Box->W) Bonus((Score/Box->W-1)*(Score/Box->W-1)*Box->W*2);
 ++LineDel;
 if(LineDel>20)
 {
  LineDel=0;
  if(Level>2) --Level;
  }
}

void Tetris::Down()
{
  CurItem->Down();
  if(*Box && *CurItem ) return;
  else
  {
  CurItem->Up();
  *Box=*Box+ *CurItem;
  int CurScore=0,Score=0;
  while( CurScore=Box->Del() )  { Score+=CurScore; Delay(1); Box->Show(); }
  GetNext(); ShowNext();
  if( !(*Box && *CurItem) )
  {
   ShowScores();
   bar(34,11,13,3,0);
   ShowStr(36,12,"Game over",12);
   unsigned long far *Timer=(unsigned long far *)0x46cl;
   unsigned long EndTime=*Timer+10;
   while(*Timer<EndTime) if(bioskey(1)) InputKey();
    InputKey(); exit=1; return ;
   }
  CheckLevel(Score);
  ShowScores();
 }
}

void Tetris::Drop()
{
 CurItem->Down(); if(!(*Box && *CurItem) ){ CurItem->Up(); Down(); return; }
 ++Scores;
 while(*Box && *CurItem ) CurItem->Down();
 CurItem->Up();
}

long Tetris::Run()
{
 exit=0;
 bar(Box->X*2-2,Box->Y,Box->W*2+4,Box->H+1,8);
 ShowStr(XNext<<1,YNext-2,"Next",15);
 ShowScores();
 GetNext(); GetNext(); Scores=0; ShowNext();

 TItem Bar;

 if( !(*Box && *CurItem) ) return Scores;
 Box->Show();
 CurItem->Show();
for(;;)
{
  if(exit) return Scores;
 Bar=*Box+ *CurItem;
 Bar.Show();
 if(Delay(Level)) Down();
 else
 {
  int Key=InputKey();
  if(Key==LeftKey){ CurItem->Left(); if(!(*Box && *CurItem ))  CurItem->Right(); }
   else
  if(Key==RightKey){ CurItem->Right(); if(!(*Box && *CurItem )) CurItem->Left(); }
   else
  if(Key==RotKey){ if(*Box && CurItem->Rot()) *CurItem=CurItem->Rot();}
   else
  if(Key==DropKey) Drop();
   else
  if(Key==QuitKey) return Scores;
   else
    Down();
   }

 }
}

//------------------------------------------------------------------------------

class	TMenu
{
 char	**Items;
 int 	CurItem;
 int	ItemAll;
 int	X,Y,Col1,Col2;
public:
 TMenu(int x,int y,int col1,int col2,int items)
 { Col1=col1; Col2=col2; ItemAll=items; X=x; Y=y; Items=new (char**)[ItemAll]; CurItem=0; }
 ~TMenu() { delete Items; }
 void AddItem(char *item);
 void Show();
 int  Get();
};

void TMenu::Show() { for(int i=0;i<ItemAll;++i) ShowStr(X,Y+i,Items[i],Col1); if(CurItem>=ItemAll) CurItem=0; ShowStr(X,Y+CurItem,Items[CurItem],Col2);}

void TMenu::AddItem(char *item)
{ if(CurItem<ItemAll) { Items[CurItem]=item; CurItem++; } }

int TMenu::Get()
{
 Show();
 for(;;)
 {
  switch(InputKey())
  {
   case 0x4800: CurItem--; if(CurItem<0) CurItem=ItemAll-1; break;
   case 0x5000: CurItem++; if(CurItem==ItemAll) CurItem=0; break;
   case	0x11b : return 0;
   case	0x1c0d: return CurItem+1;
  }
  Show();
 }
}


struct TItemScore
{
 char Name[20];
 long Score;
};


class TScoreTabl
{
 char flag;
 char *Path;
 TItemScore *ScoreTabl;
 enum { Items=10 ,X=29,Y=7 };
 enum { Error,TablEmpty,TablOk };
public:
 TScoreTabl(char *path);
 ~TScoreTabl(){ delete ScoreTabl; }
 void Write();
 void Show();
 void NewScore(long NewScore);
 void Xor();
};

void TScoreTabl::Xor() { for(int i=0; i<sizeof(TItemScore)*Items;++i)((char*)ScoreTabl)[i]^=0x55; }

TScoreTabl::TScoreTabl(char *path)
{
 flag=Error;
 Path=path;
 int handle=_open(path,O_RDONLY); if(handle==-1) return; else flag=TablEmpty;
 ScoreTabl=new TItemScore[Items];
 lseek(handle,-(long)(sizeof(TItemScore)*Items+4),SEEK_END);
 unsigned long label;
 _read(handle,&label,4);
 if(label!=0x5a5a5a5al) { setmem(ScoreTabl,sizeof(TItemScore)*Items,0); _close(handle); return; } else flag=TablOk;
 _read(handle,ScoreTabl,sizeof(TItemScore)*Items);
 _close(handle);
 Xor();
}

void TScoreTabl::Write()
{
 Xor();
 int handle=_open(Path,O_WRONLY); if(handle==-1) return;
 if(flag==TablOk) lseek(handle,-(long)(sizeof(TItemScore)*Items+4),SEEK_END);
  else lseek(handle,0,SEEK_END);
 unsigned long label=0x5a5a5a5al;
  flag=TablOk;
 _write(handle,&label,4);
 _write(handle,ScoreTabl,sizeof(TItemScore)*Items);
 _close(handle);
 Xor();
}

void TScoreTabl::Show()
{
 ShowStr(35,5,"Score Table",12);
 for(int i=0;i<Items;++i)
 {
  ShowDigit(X-3,Y+i,i+1,7); ShowStr(X-2,Y+i,".",7);
  ShowStr(X,Y+i,ScoreTabl[i].Name,7);
  ShowDigit(X+27,Y+i,ScoreTabl[i].Score,7);
 }
}


void TScoreTabl::NewScore(long NewScore)
{
 int i;
 for(i=0;i<Items;i++)
 if(NewScore>ScoreTabl[i].Score)
 {
  if(i<Items-1) movmem(ScoreTabl+i,ScoreTabl+i+1,(Items-i-1)*sizeof(TItemScore));
  setmem(ScoreTabl[i].Name,sizeof(TItemScore),0);
  ScoreTabl[i].Score=NewScore;
  Show();
  Input(X,Y+i,19,ScoreTabl[i].Name,14);
  Show();
  InputKey();
  Write();
  return;
  }
}

void BossKey()
{
 unsigned far *Video=(unsigned far *)0xb8000000l;
  for(int i=0;i<80*25;++i)
  {
   unsigned Tmp=Video[i];
   Video[i]=BossScreen[i];
   BossScreen[i]=Tmp;
 }
}


void main(int argc,char **argv)
{
  randomize();

  asm{ mov	ax,3
       int	10h }

  SetCur(26,26);

  TMenu Menu(36,8,7,10,8);
  Menu.AddItem("Tetris");
  Menu.AddItem("Pentix");
  Menu.AddItem("TetColor");
  Menu.AddItem("Columns");
  Menu.AddItem("Level");
  Menu.AddItem("Define Keys");
  Menu.AddItem("Show Scores");
  Menu.AddItem("Quit");

  Tetris *CurTet;
  TScoreTabl ScoreTabl(argv[0]);

  for(;;)
  {
   cls();
   ShowStr(30,6,"Enter your liked game",12);
  int i=Menu.Get();
  cls();
  switch(i)
  {
   case 1:  CurTet=new Tetris(15,3,10,20,5,5); break;
   case 2:  CurTet=new Pentix(14,3,12,20,5,5); break;
   case 3:  CurTet=new TetColor(16,3,8,20,5,5); break;
   case 4:  CurTet=new Columns(16,3,8,20,5,5); break;
   case 5:  SetLevel(); continue;
   case 6:  DefineKey(); continue;
   case 7:  ScoreTabl.Show(); InputKey(); continue;
   default: exit(0);
   }
  long CurScore=CurTet->Run();
  delete CurTet;
  cls();
  ScoreTabl.NewScore(CurScore);
  }
}















